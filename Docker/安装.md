## 安装

### 安装流程

* 删除旧版本 docker

  ```shell
  sudo apt remove docker docker-engine docker.io
  ```

* 安装依赖

  ```shell
  sudo apt install apt-transport-https ca-certificates curl gnupg2 software-properties-common
  ```

* 信任 Dockers 的 GPG 公钥

  ```shell
  curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
  ```

* 对于 amd64 架构的计算机，添加软件仓库

  ```shell
  sudo add-apt-repository \
  	"deb [arch=amd64] https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/ubuntu \
  	stable"
  ```

* 安装 docker-ce

  ```shell
  sudo apt update
  sudo apt install docker-ce
  ```

### 卸载

* 卸载 `Docker CE` 软件包

  ```shell
  sudo apt purge docker-ce
  ```

* 删除所有 image，容器，卷

  ```shell
  sudo rn -rf /var/lib/docker
  ```

### 简单使用

* 添加用户到 `docker` 组，注销并重新登录后生效

  ```shell
  sudo usermod -aG docker your-user
  ```

### 配置 docker 在启动时启动

* 开启

  ```shell
  sudo systemctl enable docker
  ```

* 关闭

  ```shell
  sudo systemctl disable docker
  ```

### 配置 Docker 守护程序监听连接

默认情况下，Docker 守护程序监听 unix 套接字上的连接以接受来自本地客户端的请求。通过将 `docker` 配置为监听 IP 地址以及 Unix 套接字，可以允许 `Docker` 接受来自远程主机的请求。可以使用 `docker.service` 或 `daemon.json`，但是不能两个一起使用

#### 使用 `docker.service`

* 编辑 `docker.service` 

  ```shell
  sudo systemctl edit docker.service
  ```

* 添加或修改

  ```shell
  [Service]
  ExecStart=
  ExecStart=/usr/bin/dockerd -H fd:// -H tcp://127.0.0.1:2375
  ```

* 保存

* 重载 `systemctl` 配置

  ```shell
  sudo systemctl daemon-reload
  ```

* 重启 `docker`

  ```shell
  sudo systemctl restart docker.service
  ```

#### 使用 `daemon.json`

* 配置 `/etc/docker/daemon.json`

  ```json
  {
      "hosts": ["unix:///var/run/docker.sock", "tcp://127.0.0.1:2375"]
  }
  ```

* 重启 `docker`

  ```shell
  sudo systemctl restart docker.service
  ```





