## 链路层

### 概述

在 TCP/IP 协议中，链路层主要有三个目的：

* 为 IP 模块发送和接收 IP 数据报
* 为 ARP 模块发生 ARP 请求和接收 ARP 应答
* 为 RARP 发生 RARP 请求和接收 RARP 应答

TCP/IP 支持多种不同的链路层协议，这取决于网络所使用的硬件，如以太网、令牌环网、FDDI（光纤分布式数据接口）RS-232 串行线路等

### 以太网和 IEEE 802 封装

以太网是当今 TCP/IP 采用的主要的局域网技术。它采用一种称作 `CSMA/CD` 的媒体接入方法，其意思是带冲突检测的载波侦听多路接入。它的速率为 10mb/s，地址为 48bit

在 TCP/IP 中，以太网 IP 数据报的封装是在 RFC 894 中定义的，IEEE 802 网络的 IP 数据报封装是在 RFC 1042 中定义的。主机需求 RFC 要求每台 Internet 主机都与一个 10 Mb/s 的以太网电缆相连接：

1.必须能发送和接收采用 RFC 894 （以太网）封装格式的分组

2.应该能接收与 RFC 894 混合的 RFC 1042 （IEEE 802）封装格式的分组

3.也许能够发送采用 RFC 1042 格式封装的分组。如果主机能同时发送两种类型的分组数据，那么发送的分组必须是可以设置的，而且默认条件下必须是 RFC 894 分组

最常使用的封装格式是 RFC 894 定义的格式。两种帧格式都采用 48 bit（6字节）的目的地址和源地址（802.3 允许使用 16 bit 的地址，但一般是 48 bit 地址）即硬件地址。ARP 和 RARP 协议对 32 bit 的 IP 地址和 48 bit 的硬件地址进行映射。接下来的 2 个字节在两种帧格式中互不相同。在 802 标准定义的帧格式中，长度字段是指它后续数据的字节长度，但不包括 CRC 检验码。而以太网的类型字段定义了后续数据的类型。在 802 标准定义的帧格式中，类型字段则由后续的子网接入协议的首部给出。802 定义的有效长度值与以太网的有效类型值无一相同，这样就可以对两种帧格式进行区分。

![](./Images/以太网封装格式.png)

在以太网帧格式中，类型字段之后就是数据：而在 802 帧格式中，跟随在后面的是 3 字节的 802.2 LLC 和 5 字节的 802.2 SNAP。目的服务访问点（Destination Service Access Point，DSAP）和源服务访问点（Source Service Access Point，SSAP）的值都设为 `Oxaa`。`cntl