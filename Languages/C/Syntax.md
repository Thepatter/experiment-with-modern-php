### Syntax

#### 一般语法

##### 头文件

`#include` 是预处理指令（preprocessor directive，编译前对源码做的准备工作）。头文件包含了编译器创建最终可执行程序要用到的信息（常量、函数）

##### main 函数

C 程序从 main 函数开始执行。

##### 声明

C99/C11 可以在块中任何位置声明变量，之前只能在块的顶部声明。C99/C11 允许使用更长的标识符名，编译器只识别前 63 个字符（如果两个标识符名都是 64 个字符，只有最后一个字符不同，那么编译器可能将其视为同一个名称，也可能不会，其行为是未定义的）。对外部标识符，只允许使用 31 个字符。C90 只允许 6 个字符。

C90 标准新增了函数原型，告知编译器正在使用某函数，函数原型指明了函数的属性，早期 C 语言支持只指定返回类型不用指定参数的声明。标准库函数提供了函数原型

###### 常量

```
#define NAME value
```

编译程序时，程序中所有的常量会被替换成常量值，这样定义的常量被称为明示常量（manifest constant）

*limis.h 中明示常量*

|             明示常量              |                      含义                      |
| :-------------------------------: | :--------------------------------------------: |
|            `CHAR_BIT`             |                char 类型的位数                 |
|       `CHAR_MAX`/`CHAR_MIN`       |               char 类型最大/小值               |
|      `SCHAR_MAX`/`SCHAR_MIN`      |           signed char 类型最大/小值            |
|      `UCHAR_MAX`/`UCHAR_MIN`      |          unsigned char 类型最大/小值           |
|       `SHRT_MAX`/`SHRT_MIN`       |              short 类型最大/小值               |
|            `USHRT_MAX`            |             Unsigned short 最大值              |
|        `INT_MAX`/`INT_MIN`        |               Int 类型最大/小值                |
|            `UINT_MAX`             |              Unsigned int 最大值               |
|       `LONG_MAX`/`LONG_MIN`       |               Long 类型最大/小值               |
|            `ULONG_MAX`            |           Unsigned long 类型的最大值           |
|      `LLONG_MAX`/`LLONG_MIN`      |            Long long 类型最大/小值             |
|           `ULLONG_MAX`            |         imsigned Long long 类型最大值          |
|          `FLT_MANI_DIG`           |              float 类型的尾数位数              |
|             `FLT_DIG`             |     Float 类型的最少有效数字位数（十进制）     |
| `FLT_MIN_10_EXP`/`FLT_MAX_10_EXP` |     Float 类型最小负/正指数（以 10 为底）      |
|        `FLT_MIN`/`FLT_MAX`        |              float 类型的最大正数              |
|           `FLT_EPSILON`           | 1.00 和比 1.00 大的最小 float 类型值之间的差值 |



###### const 限定符

C90 新增了 const 关键字，用于限定一个变量为只读。

##### 基本数据类型

由以下关键字定义组合而成：int、long、short、unsigned、char、float、double、signed、`_Bool`、`_Complex`、`_Imaginary`

可以使用 sizeof（以字节为单位给出指定类型的大小）来获取基本类型占用字节数

```c
# C99/C11 使用 %zd 转换 sizeof 返回类型，之前使用 %u/%lu 代替
printf("long double size %zd bytes\n", sizeof(long double)); // 16 bytes
```

###### Int

ISO C 规定 int 的取值范围最小为 -32768～32767，即不小于 16 位。

%d 十进制显示数字，%o 八进制显示数字，%x 十六进制显示数字，显示前缀 0、0x、0X，使用 %#o、%#x、%#X。C 语言提供了：short、long、unsigned 修饰整数，整数溢出行为是未定义的，可能会从该类型最小值开始重新计数

*   short int 

    占用空间可能比 int 少（最大 short 类型小于等于最大 int 类型整数，至少占 16 位），有符号，标准规定 short 占用存储空间不能多于 int，使用 h 前缀，可以和 u 一起使用表示无符号 short 打印

*   long int

    占用空间可能比 int duo，有符号，long 占用空间不能少于 int，至少占 32 位

*   long long int

    C99 加入，占用空间可能比 long 多，至少占 64 位，有符号，可以使用 ll LL ull LLU ULL 表示

###### char

存储字符，实际存储的是整数型，C 语言把 1 字节定义为 char 类型占用的位数。C 语言将字符常量视为 int 类型而非 char 类型。直接表示字符常量时，使用单引号将字符括起来，还一个在八进制或十六进制前加一个反斜杠表示 ASCII 中的一个字符（`\007`）

打印 char 时，使用 %d 将打印一个整数值，使用 %c 将打印字符值。有些编译器将 char 实现为有符号类型，表示范围为 -128～127，有些编译器将 char 实现为无符号类型，表示范围是 0～255。C90 标准，允许使用 signed 或 unsigned 修饰 char。

| 字符 |   含义   |                           标准                            |
| :--: | :------: | :-------------------------------------------------------: |
| `\a` |   警报   |                     不得改变活跃位置                      |
| `\b` |   退格   |                       活跃位置退格                        |
| `\f` |   换页   |                  活跃位置移到下一页开始                   |
| `\n` |   换行   |                活跃位置移至下一行开始出处                 |
| `\r` |   回车   |                活跃位置移动到当前行开始处                 |
| `\t` | 水平制表 | 活跃位置移至下一个水平制表点（第1、9、17、25 等字符位置） |
| `\v` | 垂直制表 |               活跃位置移至下一个垂直制表点                |

*   活跃位置，显示设备中下一个字符将出现的位置，如光标。换页、垂直在 PC 屏幕会产生奇怪的符号，光标并不会移动，只有将其输出到打印机才会有效果

*   `\\`、`\'`、`\"` 用于打印，`\0oo`、`\xhh`

    ```c
    # 如果要用八进制 ASCII 码表示一个字符，可以在编码值前加一个反斜杠并用单引号括起来
    # 使用 '\x' 或 '\x0' 表示十六进制
    beep = '\007'; # 可以省略前面的 0，'\07', '\7' 编译器都能识别
    ```

*   无论是普通字符还是转义字符，只要是双引号括起来的字符集合（字符串），就无需用单引号括起来。

###### _Bool

C99 标准添加了 _Bool 类型用于表示布尔值，true/false，使用 1 表示 true，0 表示 false，仅占用 1 位存储空间

###### float

浮点类型有 float、double、long double（C90 新增），double 和 float 类型最小取值范围相同，至少能表示 10 位有效数字。一般情况下 double 占用 64 位。C 只保证 long double 至少与 double 类型精度相同。默认情况下，编译器假定浮点型（没有后缀）常量是 double 类型的精度。f/F 后缀表示 float 类型。l/L 后缀为 long double 类型。使用 %f 打印 float/double 浮点数。打印 long double 使用 %Lf、%Le、%La 转换。未在函数原型中显式说明参数类型的函数，传递参数时，编译器会把 float 类型的值自动转换成 double 类型

*   上溢（数字过大，超过当前类型表达范围）浮点数溢出时显示一个表示无穷大的特定值（inf/infinity）
*   下溢（损失了指数精度），C 语言把损失了类型全精度的浮点值称为低于正常的（subnormal）浮点值。把最小的浮点数除 2 将一个一个低于正常的值，如果除非常大的值，会导致所有的位都为 0
*   NaN 特殊浮点值，部分函数结果返回该值（asin 函数传入大于 1 的参数）

C99 新增了用十六进制表示浮点常量，在十六进制数前加上十六进制前缀，用 p/P 代替 e/E，用 2 的幂代替 10 的幂，并非所有编译器都支持 C99 这一特性。打印十六进制浮点数，用 a/A 代替 e/E。

C 编译器把浮点数转换成整数时，直接丢弃小数部分。

###### `_Complex/_Imaginary`

C99 标准支持复数和虚数类型。C11 标准把整个复数软件包作为可选项。

C 语言复数类型：float _Complex（包含两个 float 类型的值，表示复数的实部和虚部）、double _Complex、long double _Complex

C 语言的虚数类型：float _Imaginary、double _Imaginary、long double _Imaginary

引入 complex.h 头文件，可用 complex 代替 _Complex，用 imaginary 代替 _Imaginary，用 l 代替 -1 的平方根

##### 复合类型

###### 字符串

C 语言没有专门用于存储字符串的变量类型，字符串都被存储在 char 类型的数组中。使用 `\0` 字符（不可打印字符）来标记字符串的结束。

使用 sizeof 计算字符串字符数时会包含末尾不可见的空字符。sizeof 函数运算对象是类型时要使用圆括号，对于特定量可以省略圆括号

*转换说明*

| 占位符 |                             说明                             |
| :----: | :----------------------------------------------------------: |
| %a/%A  |           浮点数、十六进制数和 p 记数法（C99/C11）           |
|   %c   |                           单个字符                           |
| %d/%i  |                       有符号十进制整数                       |
| %e/%E  |                       浮点数、e 记数法                       |
|   %f   |                     浮点数、十进制计数法                     |
| %g/%G  | 根据值自动选择 %f/%e（%e 格式用于指数小于 -4 或大于等于精度时） |
|   %o   |                       无符号八进制整数                       |
|   %p   |                             指针                             |
|   %s   |                            字符串                            |
|   %u   |                       无符号十进制整数                       |
| %x/%X  |           无符号十六进制整数，使用十六进制数 Of/OF           |
|   %%   |                            百分号                            |

*   printf()

    修饰符

    | 修饰符 |                             含义                             |
    | :----: | :----------------------------------------------------------: |
    |  数字  | 最小字段宽度，如果该字段不能容纳待打印的数字或字符串，系统会使用更宽的字段（%4d） |
    | .数字  | 精度，%e/%E/%f，表示小数点右边数字的位数；%g/%G 表示有效数组最大位数；%s 转换，表示待打印字符的最大数量；对于整型，表示打印数字最小位数；只使用 . 表示其后跟随一个 0，%.f 和 %.0f 相同 |
    |   h    | 和整型转换说明一起使用，表示 short int/unsigned short int：%hu、%hx、%6.4hd |
    |   hh   | 和整型转换说明一起使用，表示 signed char/unsigned char 类型值：%hhu、%hhx、%6.4hd |
    |   j    | 和整型转换一起使用，表示 intmax_t/uintmax_t 类型的值：%jd、%8jx |
    |   l    | 和整型转换一起使用，表示 long int/unsigned long int 类型值：%ld、%81u |
    |   ll   | 和整型转换一起使用，表示 long long int/unsigned long long int 类型值：%11d、%10.4Le |
    |   L    |      和浮点转换一起使用，表示 long double：%Lf、%10.4Le      |
    |   t    | 和整数转换说明一起使用，表示 ptrdiff_t 类型值（两个指针差值的类型 C99），%td、%12ti |
    |   z    | 和整型转换一起使用，表示 size_t 类型（sizeof 返回的类型 C99）的值，%zd、%12zd |

*   scanf()

##### 头文件

###### stdint.h/inttypes.h

C99 新增，为现有类型创建了更多类型名，新的类型名定义在 stdint.h 头文件中，编译器会将其替换为当前系统匹配的类型以确保移植性

|    类型     |                    用途                    |
| :---------: | :----------------------------------------: |
|  `int32_t`  |              32 位有符号整数               |
| `intmax_t`  |               最大有符号整型               |
| `uintmax_t` | 最大无符号整数，可能大于 usigned long long |

*   精确宽度类型（exact-width integer type）

    `int32_t` 表示整数类型的宽度正好是 32 位，精确宽度类型是可选项

*   最小宽度类型（minimum width type）

    `int_least8_t` 即可容纳 8 位有符号整数值的类型中宽度最小的类型的别名

*   最快最小宽度类型（fastst minimum width type）

    `int_fast8_t` 系统中对 8 位有符号值而言最快的整数类型的别名

inttypes.h 中提供了可移植字符串宏来显示可移植类型：

*   PRId32 字符串宏打印 32 位有符号值

    ```c
    int32_t me32 = 45933945;
    printf("me32 = %" PRId32 "\n", me32);
    ```

    