## 通过 EXPLAIN 语句分析 SQL 执行及性能

### EXPLAIN 命令概述

EXPLAIN 命令是查看查询优化器是如何决定执行查询的主要方法。这个功能有局限性，并不总是正确。

#### 使用 EXPLAIN 命令

要使用 EXPLAIN 命令，只需在查询中的 SELECT 关键字前添加 EXPLAIN。MySQL 会在查询上设置一个标记。当执行查询时，这个标记会使其返回关于在执行计划中每一步的信息，而不是执行它。会返回一行或多行信息，显示出执行计划中的每一部分和执行的次序。在查询中每个表在输出中只有一行。如果查询时两个表的连接，输出中会有两行，别名表也算一个表（表包含：子查询，UNION 结果，实体表）

#### EXPLAIN 扩展

* EXPLAIN EXTENDED 和正常 EXPLAIN 一样，但会告诉服务器”逆向编译“执行计划为一个 SELECT 语句。可以通过紧接其后运行 `SHOW WARNINGS` 看到生成的这个语句。这个语句直接来自执行计划， 而不是原 SQL 语句。大部分场景下与原语句不同。
* EXPLAIN PRITITIONS 会显示查询将访问的分区，如果查询时基于分区表的话

#### EXPLAIN 局限性

* 如果查询在 FROM 子句中包括子查询，MySQL 实际会执行子查询，将其结果放在临时表中，然后完成外层查询优化。必须在完成外层查询优化之前处理类似的子查询。在 5.6 中取消该限制
* EXPLAIN 是近似结果
* 不区分具有相同名字的事物。内存排序和临时文件都使用 `filesort`，磁盘和内存临时表都显示 `Using temporary`
* 不会显示执行计划的所有信息，及特定优化，不支持存储过程。
* 不支持 SELECT 以为语句

### EXPLAIN 中的列

#### id 列


#### Extra 列字段含义

* `Using where`
  
  表示 MySQL 服务器将存储引擎返回行以后再应用 WHERE 过滤条件，此时引擎层已锁住获取的所有行

