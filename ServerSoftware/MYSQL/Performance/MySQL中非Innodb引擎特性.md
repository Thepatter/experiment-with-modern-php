# 非 `InnoDB` 引擎

##  `MyISAM` 存储引擎

### 存储

`MyISAM` 将表存储在两个文件中：数据文件和索引文件，分别以 `.MYD` 和 `.MYI` 为扩展名。`MyISAM` 表可以包含动态或者静态（长度固定）行。在 MySQL 5.0 中，`MyISAM` 表如果是变长行，则默认配置只能处理 256 TB 的数据。而所有的 MySQL 版本都支持 8 字节的指针。要改变 `MyISAM` 表指针的长度，可以通过修改表的 `MAX_ROWS` 和 `AVG_ROW_LENGTH` 选项的值来实现，两者相乘就是表可能达到的最大大小。修改这两个参数会导致重建整个表和表的所有索引，这会消耗大量时间

### 加锁与并发

`MyISAM` 对整张表加锁，而不是针对行。读取时会对需要读到的所有表加共享锁，写入时则对表加排他锁。但是在表有读取的同时，也可以往表中插入新的记录（即，并发插入，`CONCURRENT INSERT`)

### 修复

对于 `MyISAM` 表，MySQL 可以手工或自动执行检查和修复操作。通过 `CHECK TABLE mytable` 检查表错误。如果有错误可以通过执行 `PERAIR TABLE mytable` 进行修复。在 `MySql` 关闭期间，可以通过 `myisamchk` 命令行工具进行检查和修复操作

### 延迟更新索引键

创建 `MyISAM` 表的时候，如果指定了 `DELAY_KEY_WRITE` 选项，在每次修改执行完成时，不会立刻将修改的索引数据写入磁盘，会写到内存中的键缓冲区，只有在清理键缓冲区或者关闭表的时候才会将对应的索引块写入到磁盘。这种方式可以极大的提升写入性能，但是在数据库或者主机崩溃时会造成索引损坏，需要执行修复操作。延迟更新索引键的特性，可以在全局设置，也可以为单个表设置

### MyISAM 压缩表

如果表在创建并导入数据以后，不会再进行修改操作，那么这样的表或许适合采用 `MyISAM` 压缩表。可以使用 `myisampack` 对 `MyISAM` 表进行压缩。压缩表时不能进行修改的。压缩表可以极大的减少磁盘占用空间，减少磁盘I/O，压缩表支持只读索引。压缩表中的记录时独立压缩的，索引读取单行的时候不需要去解压整个表（甚至不解压所在的整个页面）

## Archive 引擎

Archive 存储引擎只支持 `INSERT` 和 `SELECT` 操作，会缓存所有的写并利用 `zlib` 对插入的行进行压缩，但每次 `SELECT` 查询要执行全表扫描。Archive 表适合日志和数据采集类应用，这类应用做数据分析时往往需要全表扫描。或者再一些需要更快速的 `INSERT` 操作的场合下也可以使用

Archive 引擎支持行锁和专用的缓冲区，可以实现高并发的插入。在一个查询开始直到返回表中存在的所有行数之前，Archive 引擎会阻止其他的 `SELECT` 执行，以实现一致性读。也实现了批量插入在完成之前对读操作是不可见的。

Archive 引擎不是一个事务型的引擎，而是一个针对高速插入和压缩做了优化的简单引擎

## Blackhole 引擎

Blackhole 引擎没有实现任何的存储机制，它会丢弃所有插入的数据，不做任何保存。但是服务器会记录 `Blackhole` 表的日志，可用于复制数据到备库，或者只是简单地记录到日志。这种特殊的存储引擎可以在一些特殊的复制架构和日志审核时发挥作用。

## CSV 引擎

CSV 引擎可以将普通的 CSV文件作为 MySQL  的表来处理。但这种表不支持所有。可以在数据库运行时拷入或者拷出文件。将 Excel 的数据存储为 CSV 文件，然后复制到 MySQL 数据目录下，就能在 MySQL 中打开使用。如果将数据写入到一个 CSV 引擎表，其他的外表程序也能立即从表的数据文件中读取 CSV 格式的数据。可以将 CSV 引擎作为一种数据交换机制

## Federated 引擎

Federated 引擎是访问其他 Mysql 服务器的一个代理，它会创建一个到远程 MySQL 服务器的客户端连接，并将查询传输到远程服务器执行，然后提取或者发送需要的数据。

## Memory 引擎

如果需要快速地访问数据，并且这些数据不会被修改，重启后丢失也不影响。则可以使用 `Memory` 引擎。Memory 表所有地数据都保存在内存中，不需要进行磁盘I/O，Memory 表地结构在重启以后还会保留，但数据会丢失。

Memory 表的应用场景

* 用于查找或者映射表
* 用于缓存周期性聚合数据的结果
* 用于保存数据分析中产生的中间数据

Memory 表支持 Hash 索引，表级锁，每行的长度是固定的

如果 MySQL 在执行查询的过程中需要使用临时表来保存中间结果，如果中间结果太大超出了 Memory 表限制，或含有 BLOB 或 TEXT 字段，则临时表会转换成 `MyISAM` 表(临时表是使用 `CREATE TEMPORARY TABLE` 语句创建的表，它可以使用任何引擎，临时表只在单个连接中可见，当连接断开时，临时表也将销毁)

## 第三方引擎

## OLTP 类引擎

`Percona` 的 `XtraDB` 存储引擎是基于 `InnoDB` 引擎的一个改进版本，已经包含在 `Percona Server` 和 `MariaDB` 中，它的改进主要集中在性能、可测量性和操作灵活性方面。`XtraDB` 可以作为 `InnoDB` 的一个完全替代品，可以兼容读写 `InnoDB` 的数据文件，并支持 `InnoDB` 的所有查询

## 面向列的存储引擎

MySQL默认是面向行的，每一行的数据是一起存储的，服务器的查询也是以行为单位处理的。而在大数据处理时，面向列的方式可能效率更高。如果不需要整行的数据，面向列的方式效率更高。如果不需要整行的数据，面向列的方式可以传输更少的数据。如果每一列都单独存储，压缩率也会更高